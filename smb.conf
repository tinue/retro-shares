[global]
    # Server identification
    netbios name = RETRO
    workgroup = WORKGROUP
    server string = Retro File Server

    # Network settings - let Samba auto-detect interfaces
    # With host networking, interface names vary (eth0, en0, enp0s3, etc.)
    bind interfaces only = no

    # Legacy protocol support for DOS, OS/2, Windows 9x
    server min protocol = LANMAN1
    client min protocol = LANMAN1
    lanman auth = yes
    client lanman auth = Yes
    client plaintext auth = Yes
    ntlm auth = ntlmv1-permitted
    raw NTLMv2 auth = yes

    # Disable SMB encryption for legacy client compatibility
    server signing = disabled
    client signing = disabled
    smb encrypt = disabled

    # NetBIOS support (required for legacy clients)
    disable netbios = no
    dns proxy = no

    # Guest/anonymous access settings
    map to guest = Bad User
    guest account = nobody

    # Security settings
    security = user
    passdb backend = tdbsam

    # Logging
    log file = /var/log/samba/log.%m
    max log size = 50
    # Base log level 0 suppresses deprecation warnings for legacy protocol options
    # (lanman auth, client lanman auth, etc.) which we intentionally use
    log level = 0

    # Disable printing (not needed, suppresses "pcap cache not loaded" warning)
    load printers = no
    printing = bsd
    printcap name = /dev/null
    disable spoolss = yes

    # Performance settings for slow clients
    socket options = TCP_NODELAY
    use sendfile = yes

    # DOS attribute support
    store dos attributes = yes
    map archive = yes
    map hidden = yes
    map system = yes
    map readonly = yes

    # Character encoding for legacy clients
    dos charset = CP850
    unix charset = UTF-8

[retro]
    comment = Retro Software Share
    path = /srv/retro
    browseable = yes

    # Anonymous read-only access
    guest ok = yes
    guest only = no
    public = yes

    # Authenticated users get write access
    read only = no
    write list = @smbusers

    # Force files to be readable by guests
    create mask = 0644
    directory mask = 0755
    force create mode = 0644
    force directory mode = 0755

    # Disable oplocks for better compatibility with legacy clients
    oplocks = no
    level2 oplocks = no
    blocking locks = no
